
%% Import data from spreadsheet
% Script for importing data from the following spreadsheet:
%
%    Workbook: /Users/fmorency/Documents/MATLAB/trajectoire-plaque-ki/pdfmap/Simulations_Tachikawa3D.xlsx
%    Worksheet: empreintes
%
% To extend the code for use with different selected data or a different
% spreadsheet, generate a function instead of a script.

% Auto-generated by MATLAB on 2018/11/21 17:40:06
% modified to read two files and remove 78 lines
% this only a quick .m file for a very specific use
clear 
%% Import the data
[~, ~, raw] = xlsread('Simulations_Tachikawa3D.xlsx','empreintes');
raw = raw(:,1:2);

%% Create output variable
SimulationsTachikawa3DS3 = reshape([raw{:}],size(raw));

%% Remove line with 78,78
j=0;
for i=1:500
    if (SimulationsTachikawa3DS3(i,1) ~= 78) 
        j=j+1;
        dataT(1,j)=SimulationsTachikawa3DS3(i,1);
        dataT(2,j)=SimulationsTachikawa3DS3(i,2);
    end
end

%% Clear temporary variables
clearvars raw;

% repeat for Richards
%% Import the data
[~, ~, raw] = xlsread('Simulations_Richards.xlsx','empreintes');
raw = raw(:,1:2);

%% Create output variable
SimulationsRichardsS3 = reshape([raw{:}],size(raw));

%% Remove line with 78,78
j=0;
for i=1:500
    if (SimulationsRichardsS3(i,1) ~= 78) 
        j=j+1;
        dataR(1,j)=SimulationsRichardsS3(i,1);
        dataR(2,j)=SimulationsRichardsS3(i,2);
    end
end

%% Clear temporary variables
clearvars raw;

% Tachikawa
% Plot PDF function
% hist3 will bin the data
%xi = linspace(min(dataT(1,:)), max(dataT(1,:)), 20);
%yi = linspace(min(dataT(2,:)), max(dataT(2,:)), 20);
%calcul de la taille base sur la figure de l'article
xi = linspace(0,18,20);
yi = linspace(-6.5,6.5,20)
%hst = hist3(dataT',{xi yi},'Nbins',[120 120] );
hst = hist3(dataT','Nbins',[20 20] );
%hst = hist3(dataT','Nbins', [60 60],'CDataMode','auto','FaceColor','interp')

% normalize the histogram data
dx = xi(2)-xi(1);
dy = yi(2)-yi(1);
area = dx*dy;
pdfData = hst/sum(sum(hst));%/area;

% plot pdf
figure(2); clf
hist3(dataT','Nbins', [30 30],'CDataMode','auto','FaceColor','interp')
%contour(xi,yi,pdfData,'Fill', 'on');
axis equal

% Richards
% hist3 will bin the data
% calcul automatique de la taille
%xi = linspace(min(dataR(1,:)), max(dataR(1,:)), 20);
%yi = linspace(min(dataR(2,:)), max(dataR(2,:)), 20);
%calcul de la taille base sur la figure de l'article
xi = linspace(0,18,20);
yi = linspace(-6.5,6.5,20);
%hst = hist3(dataR',{xi yi},'Nbins',[20 20] );
hst = hist3(dataR','Nbins',[20 20] );


% normalize the histogram data
dx = xi(2)-xi(1);
dy = yi(2)-yi(1);
area = dx*dy;
pdfData = hst/sum(sum(hst));%/area;


% plot pdf
figure(1); clf
hist3(dataR','Nbins', [30 30],'CDataMode','auto','FaceColor','interp')
%contour(xi,yi,pdfData,'Fill','on');
axis equal